import{C as f}from"./codemirror.es.DhNp89ap.js";import{f as b}from"./forEachState.es.DETpARGm.js";import{e as d,f as h,i as x,m as u,h as T,d as V}from"./GraphiQLEditor.h-EeZlAI.js";import"./codemirror.es2.CXusOVRv.js";import"./index.BGCt5l70.js";function p(e,t,n){const r=v(n,g(t.string));if(!r)return;const i=null!==t.type&&/"|\w/.test(t.string[0])?t.start:t.end;return{list:r,from:{line:e.line,ch:i},to:{line:e.line,ch:t.end}}}function v(e,t){if(!t)return y(e,(e=>!e.isDeprecated));return y(y(e.map((e=>({proximity:L(g(e.text),t),entry:e}))),(e=>e.proximity<=2)),(e=>!e.entry.isDeprecated)).sort(((e,t)=>(e.entry.isDeprecated?1:0)-(t.entry.isDeprecated?1:0)||e.proximity-t.proximity||e.entry.text.length-t.entry.text.length)).map((e=>e.entry))}function y(e,t){const n=e.filter(t);return 0===n.length?e:n}function g(e){return e.toLowerCase().replaceAll(/\W/g,"")}function L(e,t){let n=j(t,e);return e.length>t.length&&(n-=e.length-t.length-1,n+=0===e.indexOf(t)?0:.5),n}function j(e,t){let n,r;const i=[],s=e.length,o=t.length;for(n=0;n<=s;n++)i[n]=[n];for(r=1;r<=o;r++)i[0][r]=r;for(n=1;n<=s;n++)for(r=1;r<=o;r++){const s=e[n-1]===t[r-1]?0:1;i[n][r]=Math.min(i[n-1][r]+1,i[n][r-1]+1,i[n-1][r-1]+s),n>1&&r>1&&e[n-1]===t[r-2]&&e[n-2]===t[r-1]&&(i[n][r]=Math.min(i[n][r],i[n-2][r-2]+s))}return i[s][o]}function O(e,t,n){const r="Invalid"===t.state.kind?t.state.prevState:t.state,{kind:i,step:s}=r;if("Document"===i&&0===s)return p(e,t,[{text:"{"}]);const{variableToType:o}=n;if(!o)return;const a=N(o,t.state);if("Document"===i||"Variable"===i&&0===s){return p(e,t,Object.keys(o).map((e=>({text:`"${e}": `,type:o[e]}))))}if(("ObjectValue"===i||"ObjectField"===i&&0===s)&&a.fields){return p(e,t,Object.keys(a.fields).map((e=>a.fields[e])).map((e=>({text:`"${e.name}": `,type:e.type,description:e.description}))))}if("StringValue"===i||"NumberValue"===i||"BooleanValue"===i||"NullValue"===i||"ListValue"===i&&1===s||"ObjectField"===i&&2===s||"Variable"===i&&2===s){const n=a.type?d(a.type):void 0;if(n instanceof h)return p(e,t,[{text:"{"}]);if(n instanceof x){return p(e,t,n.getValues().map((e=>({text:`"${e.name}"`,type:n,description:e.description}))))}if(n===u)return p(e,t,[{text:"true",type:u,description:"Not false."},{text:"false",type:u,description:"Not true."}])}}function N(e,t){const n={type:null,fields:null};return b(t,(t=>{switch(t.kind){case"Variable":n.type=e[t.name];break;case"ListValue":{const e=n.type?T(n.type):void 0;n.type=e instanceof V?e.ofType:null;break}case"ObjectValue":{const e=n.type?d(n.type):void 0;n.fields=e instanceof h?e.getFields():null;break}case"ObjectField":{const e=t.name&&n.fields?n.fields[t.name]:null;n.type=e?.type;break}}})),n}f.registerHelper("hint","graphql-variables",((e,t)=>{const n=e.getCursor(),r=e.getTokenAt(n),i=O(n,r,t);return i?.list&&i.list.length>0&&(i.from=f.Pos(i.from.line,i.from.ch),i.to=f.Pos(i.to.line,i.to.ch),f.signal(e,"hasCompletion",e,i,r)),i}));